<section class="card urmarire">
  <div class="card-header">
    <h2>🚔 Mașini date în urmărire</h2>
    <button id="addBtn" class="btn primary">➕ Adaugă urmărire</button>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>Nr. înmatriculare</th>
        <th>Nume suspect</th>
        <th>CNP</th>
        <th>Acțiuni</th>
      </tr>
    </thead>
    <tbody id="urmarireBody">
      <!-- rândurile se inserează din JS -->
    </tbody>
  </table>
</section>

<!-- MODAL FORM -->
<div id="formModal" class="modal hidden">
  <div class="modal-content">
    <h3 id="formTitle">Adaugă urmărire</h3>
    <form id="suspectForm">
      <label>Nr. înmatriculare
        <input type="text" id="nr" required>
      </label>
      <label>Nume suspect
        <input type="text" id="nume" required>
      </label>
      <label>CNP
        <input type="text" id="cnp" required>
      </label>
      <label>Mașina (marca, model, culoare)
        <input type="text" id="masina">
      </label>
      <label>Detalii faptă
        <textarea id="fapta"></textarea>
      </label>
      <div class="modal-actions">
        <button type="submit" class="btn success">💾 Salvează</button>
        <button type="button" id="cancelForm" class="btn">✖ Închide</button>
      </div>
    </form>
  </div>
</div>

<!-- MODAL VIEW -->
<div id="viewModal" class="modal hidden">
  <div class="modal-content">
    <h3>Detalii suspect</h3>
    <div id="viewDetails"></div>
    <div class="modal-actions">
      <button type="button" id="closeView" class="btn">✖ Închide</button>
    </div>
  </div>
</div>

<style>
/* GENERAL STYLE */
body {
  background: #0f172a;
  font-family: Arial, sans-serif;
  color: #e5e7eb;
}

/* CARD */
.card {
  background: #111827;
  padding: 20px;
  border-radius: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.6);
  margin-bottom: 20px;
  color: #e5e7eb;
}
.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}
.card h2 {
  font-size: 20px;
  font-weight: 600;
  color: #60a5fa;
}

/* TABLE */
.table {
  width: 100%;
  border-collapse: collapse;
}
.table th, .table td {
  padding: 12px 15px;
  border-bottom: 1px solid #374151;
  text-align: left;
}
.table th {
  background: #1e293b;
  font-weight: 600;
  color: #93c5fd;
}
.table tr:hover {
  background: #1f2937;
}

/* BUTTONS */
.btn {
  padding: 6px 12px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  transition: 0.2s;
}
.btn.primary { background: #2563eb; color: white; }
.btn.success { background: #16a34a; color: white; }
.btn.warn { background: #dc2626; color: white; }
.btn:hover { box-shadow: 0 0 10px #3b82f6; }

/* MODAL */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
}
.modal.hidden { display: none; }
.modal-content {
  background: #1f2937;
  padding: 20px;
  border-radius: 12px;
  width: 400px;
  max-width: 95%;
  color: #f3f4f6;
  box-shadow: 0 0 20px rgba(37,99,235,0.5);
}
.modal-content h3 { 
  margin-bottom: 15px; 
  color: #60a5fa;
}
.modal-content label {
  display: block;
  margin-bottom: 10px;
  font-size: 14px;
}
.modal-content input, 
.modal-content textarea {
  width: 100%;
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #374151;
  margin-top: 4px;
  background: #111827 !important;
  color: #f3f4f6 !important;
}
.modal-actions {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 15px;
}
</style>

<script>
let suspecti = [];
let editIndex = null;

const body = document.getElementById("urmarireBody");
const formModal = document.getElementById("formModal");
const viewModal = document.getElementById("viewModal");
const form = document.getElementById("suspectForm");
const viewDetails = document.getElementById("viewDetails");

function render() {
  body.innerHTML = "";
  suspecti.forEach((s, i) => {
    body.innerHTML += `
      <tr>
        <td>${s.nr}</td>
        <td>${s.nume}</td>
        <td>${s.cnp}</td>
        <td>
          <button class="btn" onclick="view(${i})">👁 Vizualizează</button>
          <button class="btn primary" onclick="edit(${i})">✏ Editează</button>
          <button class="btn warn" onclick="del(${i})">🗑 Șterge</button>
        </td>
      </tr>`;
  });
}

document.getElementById("addBtn").onclick = () => {
  editIndex = null;
  form.reset();
  document.getElementById("formTitle").innerText = "Adaugă urmărire";
  formModal.classList.remove("hidden");
};
document.getElementById("cancelForm").onclick = () => formModal.classList.add("hidden");

form.onsubmit = (e) => {
  e.preventDefault();
  const s = {
    nr: document.getElementById("nr").value,
    nume: document.getElementById("nume").value,
    cnp: document.getElementById("cnp").value,
    masina: document.getElementById("masina").value,
    fapta: document.getElementById("fapta").value
  };
  if(editIndex !== null) suspecti[editIndex] = s;
  else suspecti.push(s);
  render();
  formModal.classList.add("hidden");
};

window.view = (i) => {
  const s = suspecti[i];
  viewDetails.innerHTML = `
    <p><b>Nr înmatriculare:</b> ${s.nr}</p>
    <p><b>Nume suspect:</b> ${s.nume}</p>
    <p><b>CNP:</b> ${s.cnp}</p>
    <p><b>Mașină:</b> ${s.masina}</p>
    <p><b>Faptă:</b> ${s.fapta}</p>`;
  viewModal.classList.remove("hidden");
};
document.getElementById("closeView").onclick = () => viewModal.classList.add("hidden");

window.edit = (i) => {
  const s = suspecti[i];
  document.getElementById("nr").value = s.nr;
  document.getElementById("nume").value = s.nume;
  document.getElementById("cnp").value = s.cnp;
  document.getElementById("masina").value = s.masina;
  document.getElementById("fapta").value = s.fapta;
  editIndex = i;
  document.getElementById("formTitle").innerText = "Editează urmărire";
  formModal.classList.remove("hidden");
};

window.del = (i) => {
  if(confirm("Sigur vrei să ștergi această urmărire?")){
    suspecti.splice(i,1);
    render();
  }
};
</script>
